# 2 리팩터링 원칙

## 2.2 두개의 모자

소프트웨어 개발의 목적을 명확히 구분해서 작업한다.

기능 추가를 할 때는 "기능 추가" 모자를 쓴 다음 기존 코드는 절대 수정하지 않는다.

진척도는 테스트를 추가해서 통과하는지 확인하는 방식으로 측정한다.

반면 리팩터링을 할때는 "리팩터링" 모자를 쓴 다음 기능 추가는 절대 하지 않기로 다짐한 뒤 오로지 코드 재구성에 전념한다.

놓친 테스트케이스를 새로 발견하는것이 아니면 테스트도 새로 만들지 않는다. (부득이 인터페이스를 변경해야 할 때만 코드 재구성에 전념한다.)

## 2.3 리팩터링을 하는 이유

### 리팩터링하면 소프트웨어 설계가  좋아진다.

같은일을 하더라도 설계가 나쁘면 코드가 길어지기 십상이다.

사실강 같은 일을 하는 코드가 여러 곳에 나타날 수 있기 때문이다.

중복 코드를 제거하면 모든 코드가 언제나 고유한 일을 수행함을 보장할 수 있으며, 이는 바람직한 설계의 핵심이다.

### 리팩터링하면 소프트웨어를 이해하기 쉬워진다.

단지 다른사람을 배려하기 위해서가 아니라, 사실 그 다른사람이 나 자신일 경우가 많기때문에 리팩터링이 더더욱 중요하다. 

### 리팩터링하면 버그를 쉽게 찾을 수 있다

코드를 이해하기 쉽다는 말은 버그를 찾기 쉽다는 말이기도 하다.

프로그램의 구조를 명확하게 다듬으면 그냥 "이럴 것 이다"라고 가정하던 점들이 분명히 드러나는데, 버그를 지나치려야 지나칠 수 없을 정도까지 명확해진다.

### 리팩터링하면 프로그래밍 속도를 높일 수 있다

한 시스템을 오래 개발하다보면 시간이 갈수록 새로운 기능을 코드베이스에 녹여내는데에 걸리는 시간이 훨씬 오래걸린다.

처음부터 좋은 설계를 마련하는것은 매우 어렵다.

리팩터링을 통하면 기존코드의 설계를 얼마든지 개선할 수 있으므로, 설령 요구사항이 바뀌더라도 설계를 지속해서 개선할 수 있다.

## 2.4 언제 리팩터링을 해야할까?

> 3의 법칙
> 
> 1. 처음에는 그냥 한다.
> 
> 2. 비슷한 일을 두번째로 진행하게 되면(중복이 생겼다는 사실에 당황스럽겠지만), 일단 계속 진행한다.
> 
> 3. 비슷한 일을 세번째 하게되면 리팩터링 한다.

### 2.4.1 준비를 위한 리팩터링: 기능을 쉽게 추가하게 만들기
